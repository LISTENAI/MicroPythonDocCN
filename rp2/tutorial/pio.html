
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Programmable IO &#8212; MicroPython 1.18 文档</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css" />
    <link rel="stylesheet" href="../../_static/customstyle.css" type="text/css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Quick reference for the WiPy" href="../../wipy/quickref.html" />
    <link rel="prev" title="Getting started with MicroPython on the RP2xxx" href="intro.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#rp2/tutorial/pio" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="MicroPython 1.18 文档"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">MicroPython 1.18 文档</span>
          <span class="md-header-nav__topic"> Programmable IO </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">MicroPython 1.18 文档</a></li>
          <li class="md-tabs__item"><a href="../quickref.html" class="md-tabs__link">Quick reference for the RP2</a></li>
          <li class="md-tabs__item"><a href="intro.html" class="md-tabs__link">Getting started with MicroPython on the RP2xxx</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="MicroPython 1.18 文档" class="md-nav__button md-logo">
      
        <img src="../../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="MicroPython 1.18 文档">MicroPython 1.18 文档</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../../library/index.html" class="md-nav__link">MicroPython libraries</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../reference/index.html" class="md-nav__link">MicroPython language and implementation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../genrst/index.html" class="md-nav__link">MicroPython differences from CPython</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../develop/index.html" class="md-nav__link">MicroPython Internals</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../license.html" class="md-nav__link">MicroPython license information</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../pyboard/quickref.html" class="md-nav__link">Quick reference for the pyboard</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../esp8266/quickref.html" class="md-nav__link">Quick reference for the ESP8266</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../esp32/quickref.html" class="md-nav__link">Quick reference for the ESP32</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html" class="md-nav__link">Quick reference for the RP2</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../general.html" class="md-nav__link">General information about the RP2xxx port</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="intro.html" class="md-nav__link">Getting started with MicroPython on the RP2xxx</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Programmable IO </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Programmable IO</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#rp2-tutorial-pio--page-root" class="md-nav__link">Programmable IO</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#an-example" class="md-nav__link">An example</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#an-example" class="md-nav__link">An example</a>
      
    
    </li></ul>
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#installing-micropython" class="md-nav__link">Installing MicroPython</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#general-board-control" class="md-nav__link">General board control</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#delay-and-timing" class="md-nav__link">Delay and timing</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#timers" class="md-nav__link">Timers</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#pins-and-gpio" class="md-nav__link">Pins and GPIO</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#programmable-io-pio" class="md-nav__link">Programmable IO (PIO)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#uart-serial-bus" class="md-nav__link">UART (serial bus)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#pwm-pulse-width-modulation" class="md-nav__link">PWM (pulse width modulation)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#adc-analog-to-digital-conversion" class="md-nav__link">ADC (analog to digital conversion)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#software-spi-bus" class="md-nav__link">Software SPI bus</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#hardware-spi-bus" class="md-nav__link">Hardware SPI bus</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#software-i2c-bus" class="md-nav__link">Software I2C bus</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#hardware-i2c-bus" class="md-nav__link">Hardware I2C bus</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#i2s-bus" class="md-nav__link">I2S bus</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#real-time-clock-rtc" class="md-nav__link">Real time clock (RTC)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#wdt-watchdog-timer" class="md-nav__link">WDT (Watchdog timer)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#onewire-driver" class="md-nav__link">OneWire driver</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../quickref.html#neopixel-and-apa106-driver" class="md-nav__link">NeoPixel and APA106 driver</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../wipy/quickref.html" class="md-nav__link">Quick reference for the WiPy</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../unix/quickref.html" class="md-nav__link">Quick reference for the UNIX and Windows ports</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../zephyr/quickref.html" class="md-nav__link">Zephyr 适配的快速参考</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#rp2-tutorial-pio--page-root" class="md-nav__link">Programmable IO</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#an-example" class="md-nav__link">An example</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="programmable-io">
<h1 id="rp2-tutorial-pio--page-root">Programmable IO<a class="headerlink" href="#rp2-tutorial-pio--page-root" title="永久链接至标题">¶</a></h1>
<p>The RP2040 has hardware support for standard communication protocols like I2C,
SPI and UART. For protocols where there is no hardware support, or where there
is a requirement of custom I/O behaviour, Programmable Input Output (PIO) comes
into play.  Also, some MicroPython applications make use of a technique called
bit banging in which pins are rapidly turned on and off to transmit data.  This
can make the entire process slow as the processor concentrates on bit banging
rather than executing other logic.  However, PIO allows bit banging to happen
in the background while the CPU is executing the main work.</p>
<p>Along with the two central Cortex-M0+ processing cores, the RP2040 has two PIO
blocks each of which has four independent state machines.  These state machines
can transfer data to/from other entities using First-In-First-Out (FIFO) buffers,
which allow the state machine and main processor to work independently yet also
synchronise their data.  Each FIFO has four words (each of 32 bits) which can be
linked to the DMA to transfer larger amounts of data.</p>
<p>All PIO instructions follow a common pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">instruction</span><span class="o">&gt;</span> <span class="o">.</span><span class="n">side</span><span class="p">(</span><span class="o">&lt;</span><span class="n">side_set_value</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">delay_value</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p>The side-set <code class="docutils literal notranslate"><span class="pre">.side(...)</span></code> and delay <code class="docutils literal notranslate"><span class="pre">[...]</span></code> parts are both optional, and if
specified allow the instruction to perform more than one operation.  This keeps
PIO programs small and efficient.</p>
<p>There are nine instructions which perform the following tasks:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">jmp()</span></code> transfers control to a different part of the code</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wait()</span></code> pauses until a particular action happens</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in_()</span></code> shifts the bits from a source (scratch register or set of pins) to the
input shift register</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">out()</span></code> shifts the bits from the output shift register to a destination</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">push()</span></code> sends data to the RX FIFO</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pull()</span></code> receives data from the TX FIFO</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mov()</span></code> moves data from a source to a destination</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">irq()</span></code> sets or clears an IRQ flag</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set()</span></code> writes a literal value to a destination</p></li>
</ul>
<p>The instruction modifiers are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.side()</span></code> sets the side-set pins at the start of the instruction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[]</span></code> delays for a certain number of cycles after execution of the instruction</p></li>
</ul>
<p>There are also directives:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">wrap_target()</span></code> specifies where the program execution will get continued from</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wrap()</span></code> specifies the instruction where the control flow of the program will
get wrapped from</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label()</span></code> sets a label for use with <code class="docutils literal notranslate"><span class="pre">jmp()</span></code> instructions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">word()</span></code> emits a raw 16-bit value which acts as an instruction in the program</p></li>
</ul>
<section id="an-example">
<h2 id="an-example">An example<a class="headerlink" href="#an-example" title="永久链接至标题">¶</a></h2>
<p>Take the <code class="docutils literal notranslate"><span class="pre">pio_1hz.py</span></code> example for a simple understanding of how to use the PIO
and state machines. Below is the code for reference.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example using PIO to blink an LED and raise an IRQ at 1Hz.</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span>
<span class="kn">import</span> <span class="nn">rp2</span>


<span class="nd">@rp2</span><span class="o">.</span><span class="n">asm_pio</span><span class="p">(</span><span class="n">set_init</span><span class="o">=</span><span class="n">rp2</span><span class="o">.</span><span class="n">PIO</span><span class="o">.</span><span class="n">OUT_LOW</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">blink_1hz</span><span class="p">():</span>
    <span class="c1"># Cycles: 1 + 1 + 6 + 32 * (30 + 1) = 1000</span>
    <span class="n">irq</span><span class="p">(</span><span class="n">rel</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="nb">set</span><span class="p">(</span><span class="n">pins</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>                  <span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">label</span><span class="p">(</span><span class="s2">"delay_high"</span><span class="p">)</span>
    <span class="n">nop</span><span class="p">()</span>                       <span class="p">[</span><span class="mi">29</span><span class="p">]</span>
    <span class="n">jmp</span><span class="p">(</span><span class="n">x_dec</span><span class="p">,</span> <span class="s2">"delay_high"</span><span class="p">)</span>

    <span class="c1"># Cycles: 1 + 7 + 32 * (30 + 1) = 1000</span>
    <span class="nb">set</span><span class="p">(</span><span class="n">pins</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>                  <span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">label</span><span class="p">(</span><span class="s2">"delay_low"</span><span class="p">)</span>
    <span class="n">nop</span><span class="p">()</span>                       <span class="p">[</span><span class="mi">29</span><span class="p">]</span>
    <span class="n">jmp</span><span class="p">(</span><span class="n">x_dec</span><span class="p">,</span> <span class="s2">"delay_low"</span><span class="p">)</span>


<span class="c1"># Create the StateMachine with the blink_1hz program, outputting on Pin(25).</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">rp2</span><span class="o">.</span><span class="n">StateMachine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">blink_1hz</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">set_base</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>

<span class="c1"># Set the IRQ handler to print the millisecond timestamp.</span>
<span class="n">sm</span><span class="o">.</span><span class="n">irq</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">ticks_ms</span><span class="p">()))</span>

<span class="c1"># Start the StateMachine.</span>
<span class="n">sm</span><span class="o">.</span><span class="n">active</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates an instance of class <a class="reference internal" href="../../library/rp2.StateMachine.html#rp2.StateMachine" title="rp2.StateMachine"><code class="xref py py-class docutils literal notranslate"><span class="pre">rp2.StateMachine</span></code></a> which runs the
<code class="docutils literal notranslate"><span class="pre">blink_1hz</span></code> program at 2000Hz, and connects to pin 25.  The <code class="docutils literal notranslate"><span class="pre">blink_1hz</span></code>
program uses the PIO to blink an LED connected to this pin at 1Hz, and also
raises an IRQ as the LED turns on.  This IRQ then calls the <code class="docutils literal notranslate"><span class="pre">lambda</span></code> function
which prints out a millisecond timestamp.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">blink_1hz</span></code> program is a PIO assembler routine.  It connects to a single
pin which is configured as an output and starts out low.  The instructions do
the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">irq(rel(0))</span></code> raises the IRQ associated with the state machine.</p></li>
<li><p>The LED is turned on via the <code class="docutils literal notranslate"><span class="pre">set(pins,</span> <span class="pre">1)</span></code> instruction.</p></li>
<li><p>The value 31 is put into register X, and then there is a delay for 5 more
cycles, specified by the <code class="docutils literal notranslate"><span class="pre">[5]</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">nop()</span> <span class="pre">[29]</span></code> instruction waits for 30 cycles.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">jmp(x_dec,</span> <span class="pre">"delay_high")</span></code> will keep looping to the <code class="docutils literal notranslate"><span class="pre">delay_high</span></code> label
as long as the register X is non-zero, and will also post-decrement X.  Since
X starts with the value 31 this jump will happen 31 times, so the <code class="docutils literal notranslate"><span class="pre">nop()</span> <span class="pre">[29]</span></code>
runs 32 times in total (note there is also one instruction cycle taken by the
<code class="docutils literal notranslate"><span class="pre">jmp</span></code> for each of these 32 loops).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set(pins,</span> <span class="pre">0)</span></code> will turn the LED off by setting pin 25 low.</p></li>
<li><p>Another 32 loops of <code class="docutils literal notranslate"><span class="pre">nop()</span> <span class="pre">[29]</span></code> and <code class="docutils literal notranslate"><span class="pre">jmp(...)</span></code> will execute.</p></li>
<li><p>Because <code class="docutils literal notranslate"><span class="pre">wrap_target()</span></code> and <code class="docutils literal notranslate"><span class="pre">wrap()</span></code> are not specified, their default will
be used and execution of the program will wrap around from the bottom to the
top.  This wrapping does not cost any execution cycles.</p></li>
</ul>
<p>The entire routine takes exactly 2000 cycles of the state machine.  Setting the
frequency of the state machine to 2000Hz makes the LED blink at 1Hz.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="intro.html" title="Getting started with MicroPython on the RP2xxx"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Getting started with MicroPython on the RP2xxx </span>
              </div>
            </a>
          
          
            <a href="../../wipy/quickref.html" title="Quick reference for the WiPy"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Quick reference for the WiPy </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright - The MicroPython Documentation is Copyright © 2014-2022, Damien P. George, Paul Sokolovsky, and contributors.
              
          </div>
            Last updated on
              14 2月 2022.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>