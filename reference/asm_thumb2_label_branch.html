
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>7. Branch instructions &#8212; MicroPython 1.18 文档</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" href="../_static/customstyle.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="8. Stack push and pop" href="asm_thumb2_stack.html" />
    <link rel="prev" title="6. Comparison instructions" href="asm_thumb2_compare.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#reference/asm_thumb2_label_branch" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="MicroPython 1.18 文档"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">MicroPython 1.18 文档</span>
          <span class="md-header-nav__topic"> 7. Branch instructions </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">MicroPython 1.18 文档</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">MicroPython 语言与实现</a></li>
          <li class="md-tabs__item"><a href="asm_thumb2_index.html" class="md-tabs__link">Inline assembler for Thumb2 architectures</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="MicroPython 1.18 文档" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="MicroPython 1.18 文档">MicroPython 1.18 文档</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../library/index.html" class="md-nav__link">MicroPython 库</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="index.html" class="md-nav__link">MicroPython 语言与实现</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="glossary.html" class="md-nav__link">词汇表</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="repl.html" class="md-nav__link">MicroPython 交互式解释器模式 （又名 REPL）</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mpremote.html" class="md-nav__link">MicroPython 远程控制: mpremote</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mpyfiles.html" class="md-nav__link">MicroPython .mpy 文件</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="isr_rules.html" class="md-nav__link">Writing interrupt handlers</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="speed_python.html" class="md-nav__link">Maximising MicroPython speed</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="constrained.html" class="md-nav__link">MicroPython on microcontrollers</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="manifest.html" class="md-nav__link">MicroPython 清单文件</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="packages.html" class="md-nav__link">分发包、包管理和部署应用程序</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_index.html" class="md-nav__link">Inline assembler for Thumb2 architectures</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_index.html#document-conventions" class="md-nav__link">Document conventions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_index.html#instruction-categories" class="md-nav__link">Instruction categories</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_mov.html" class="md-nav__link">1. Register move instructions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_ldr.html" class="md-nav__link">2. Load register from memory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_str.html" class="md-nav__link">3. Store register to memory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_logical_bit.html" class="md-nav__link">4. Logical & bitwise instructions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_arith.html" class="md-nav__link">5. Arithmetic instructions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_compare.html" class="md-nav__link">6. Comparison instructions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> 7. Branch instructions </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">7. Branch instructions</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#reference-asm-thumb2-label-branch--page-root" class="md-nav__link">7. Branch instructions</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#document-conventions" class="md-nav__link">7.1. Document conventions</a>
        </li>
        <li class="md-nav__item"><a href="#branch-to-label" class="md-nav__link">7.2. Branch to label</a>
        </li>
        <li class="md-nav__item"><a href="#long-branches" class="md-nav__link">7.3. Long branches</a>
        </li>
        <li class="md-nav__item"><a href="#subroutines-functions" class="md-nav__link">7.4. Subroutines (functions)</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_stack.html" class="md-nav__link">8. Stack push and pop</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_misc.html" class="md-nav__link">9. Miscellaneous instructions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_float.html" class="md-nav__link">10. Floating point instructions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_directives.html" class="md-nav__link">11. Assembler directives</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_index.html#usage-examples" class="md-nav__link">Usage examples</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="asm_thumb2_index.html#references" class="md-nav__link">References</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="filesystem.html" class="md-nav__link">Working with filesystems</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pyboard.py.html" class="md-nav__link">The pyboard.py tool</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../genrst/index.html" class="md-nav__link">MicroPython differences from CPython</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop/index.html" class="md-nav__link">MicroPython Internals</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../license.html" class="md-nav__link">MicroPython 开源协议信息</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../pyboard/quickref.html" class="md-nav__link">Quick reference for the pyboard</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../esp8266/quickref.html" class="md-nav__link">Quick reference for the ESP8266</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../esp32/quickref.html" class="md-nav__link">Quick reference for the ESP32</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../rp2/quickref.html" class="md-nav__link">Quick reference for the RP2</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../wipy/quickref.html" class="md-nav__link">Quick reference for the WiPy</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../unix/quickref.html" class="md-nav__link">Quick reference for the UNIX and Windows ports</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../zephyr/quickref.html" class="md-nav__link">Zephyr 适配的快速参考</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#reference-asm-thumb2-label-branch--page-root" class="md-nav__link">7. Branch instructions</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#document-conventions" class="md-nav__link">7.1. Document conventions</a>
        </li>
        <li class="md-nav__item"><a href="#branch-to-label" class="md-nav__link">7.2. Branch to label</a>
        </li>
        <li class="md-nav__item"><a href="#long-branches" class="md-nav__link">7.3. Long branches</a>
        </li>
        <li class="md-nav__item"><a href="#subroutines-functions" class="md-nav__link">7.4. Subroutines (functions)</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="branch-instructions">
<h1 id="reference-asm-thumb2-label-branch--page-root"><span class="section-number">7. </span>Branch instructions<a class="headerlink" href="#reference-asm-thumb2-label-branch--page-root" title="永久链接至标题">¶</a></h1>
<p>These cause execution to jump to a target location usually specified by a label (see the <code class="docutils literal notranslate"><span class="pre">label</span></code>
assembler directive). Conditional branches and the <code class="docutils literal notranslate"><span class="pre">it</span></code> and <code class="docutils literal notranslate"><span class="pre">ite</span></code> instructions test
the Application Program Status Register (APSR) N (negative), Z (zero), C (carry) and V
(overflow) flags to determine whether the branch should be executed.</p>
<p>Most of the exposed assembler instructions (including move operations) set the flags but
there are explicit comparison instructions to enable values to be tested.</p>
<p>Further detail on the meaning of the condition flags is provided in the section
describing comparison functions.</p>
<section id="document-conventions">
<h2 id="document-conventions"><span class="section-number">7.1. </span>Document conventions<a class="headerlink" href="#document-conventions" title="永久链接至标题">¶</a></h2>
<p>Notation: <code class="docutils literal notranslate"><span class="pre">Rm</span></code> denotes ARM registers R0-R15. <code class="docutils literal notranslate"><span class="pre">LABEL</span></code> denotes a label defined with the
<code class="docutils literal notranslate"><span class="pre">label()</span></code> assembler directive. <code class="docutils literal notranslate"><span class="pre">&lt;condition&gt;</span></code> indicates one of the following condition
specifiers:</p>
<ul class="simple">
<li><p>eq Equal to (result was zero)</p></li>
<li><p>ne Not equal</p></li>
<li><p>cs Carry set</p></li>
<li><p>cc Carry clear</p></li>
<li><p>mi Minus (negative)</p></li>
<li><p>pl Plus (positive)</p></li>
<li><p>vs Overflow set</p></li>
<li><p>vc Overflow clear</p></li>
<li><p>hi &gt; (unsigned comparison)</p></li>
<li><p>ls &lt;= (unsigned comparison)</p></li>
<li><p>ge &gt;= (signed comparison)</p></li>
<li><p>lt &lt; (signed comparison)</p></li>
<li><p>gt &gt; (signed comparison)</p></li>
<li><p>le &lt;= (signed comparison)</p></li>
</ul>
</section>
<section id="branch-to-label">
<h2 id="branch-to-label"><span class="section-number">7.2. </span>Branch to label<a class="headerlink" href="#branch-to-label" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p>b(LABEL) Unconditional branch</p></li>
<li><p>beq(LABEL) branch if equal</p></li>
<li><p>bne(LABEL) branch if not equal</p></li>
<li><p>bge(LABEL) branch if greater than or equal</p></li>
<li><p>bgt(LABEL) branch if greater than</p></li>
<li><p>blt(LABEL) branch if less than (&lt;) (signed)</p></li>
<li><p>ble(LABEL) branch if less than or equal to (&lt;=) (signed)</p></li>
<li><p>bcs(LABEL) branch if carry flag is set</p></li>
<li><p>bcc(LABEL) branch if carry flag is clear</p></li>
<li><p>bmi(LABEL) branch if negative</p></li>
<li><p>bpl(LABEL) branch if positive</p></li>
<li><p>bvs(LABEL) branch if overflow flag set</p></li>
<li><p>bvc(LABEL) branch if overflow flag is clear</p></li>
<li><p>bhi(LABEL) branch if higher (unsigned)</p></li>
<li><p>bls(LABEL) branch if lower or equal (unsigned)</p></li>
</ul>
</section>
<section id="long-branches">
<h2 id="long-branches"><span class="section-number">7.3. </span>Long branches<a class="headerlink" href="#long-branches" title="永久链接至标题">¶</a></h2>
<p>The code produced by the branch instructions listed above uses a fixed bit width to specify the
branch destination, which is PC relative. Consequently in long programs where the
branch instruction is remote from its destination the assembler will produce a “branch not in
range” error. This can be overcome with the “wide” variants such as</p>
<ul class="simple">
<li><p>beq_w(LABEL) long branch if equal</p></li>
</ul>
<p>Wide branches use 4 bytes to encode the instruction (compared with 2 bytes for standard branch instructions).</p>
</section>
<section id="subroutines-functions">
<h2 id="subroutines-functions"><span class="section-number">7.4. </span>Subroutines (functions)<a class="headerlink" href="#subroutines-functions" title="永久链接至标题">¶</a></h2>
<p>When entering a subroutine the processor stores the return address in register r14, also
known as the link register (lr). Return to the instruction after the subroutine call is
performed by updating the program counter (r15 or pc) from the link register, This
process is handled by the following instructions.</p>
<ul class="simple">
<li><p>bl(LABEL)</p></li>
</ul>
<p>Transfer execution to the instruction after <code class="docutils literal notranslate"><span class="pre">LABEL</span></code> storing the return address in
the link register (r14).</p>
<ul class="simple">
<li><p>bx(Rm) Branch to address specified by Rm.</p></li>
</ul>
<p>Typically <code class="docutils literal notranslate"><span class="pre">bx(lr)</span></code> is issued to return from a subroutine. For nested subroutines the
link register of outer scopes must be saved (usually on the stack) before performing
inner subroutine calls.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="asm_thumb2_compare.html" title="6. Comparison instructions"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> <span class="section-number">6. </span>Comparison instructions </span>
              </div>
            </a>
          
          
            <a href="asm_thumb2_stack.html" title="8. Stack push and pop"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> <span class="section-number">8. </span>Stack push and pop </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright - The MicroPython Documentation is Copyright © 2014-2022, Damien P. George, Paul Sokolovsky, and contributors.
              
          </div>
            Last updated on
              18 4月 2022.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>